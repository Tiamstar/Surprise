<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>æˆ‘ä»¬çš„åœ£è¯å›å¿†å½•</title>
    <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&display=swap" rel="stylesheet">
    <style>
        :root {
            --cube-size: 260px; --img-height: 220px; --text-height: 40px;
            --mobile-size: 200px; --mobile-img-height: 170px; --mobile-text-height: 30px;
            --christmas-red: #d42426; --christmas-green: #165b33; --gold: #ffd700;
        }
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; overflow: hidden; background: #000; font-family: "Microsoft YaHei", sans-serif; -webkit-touch-callout: none; -webkit-user-select: none; }
        
        /* ç¡®ä¿è’™å±‚åœ¨æœ€æœ€é¡¶å±‚ */
        #overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.95); z-index: 9999;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            color: white; cursor: pointer; transition: opacity 0.5s;
        }

        #snow-canvas { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 5; pointer-events: none; }
        .decorations { position: absolute; width: 100%; height: 100%; pointer-events: none; z-index: 2; }
        .tree-container { position: absolute; bottom: 5%; width: 250px; transform-origin: bottom center; animation: sway 4s ease-in-out infinite alternate; }
        .tree-left { left: 5%; } .tree-right { right: 5%; transform: scaleX(-1); animation-delay: 2s; }
        @keyframes sway { 0% { transform: rotate(2deg); } 100% { transform: rotate(-2deg); } }

        .scene { position: relative; z-index: 10; width: 100%; height: 100vh; display: flex; flex-direction: column; align-items: center; justify-content: center; perspective: 1200px; touch-action: none; }
        .cube { width: var(--cube-size); height: var(--cube-size); position: relative; transform-style: preserve-3d; transition: transform 0.1s ease-out; }
        .cube-face { position: absolute; width: var(--cube-size); height: var(--cube-size); border: 2px solid rgba(255,255,255,0.3); box-shadow: 0 0 15px var(--christmas-red), 0 0 30px var(--christmas-green); background: #111; display: flex; flex-direction: column; backface-visibility: visible; }
        .cube-face img { width: 100%; height: var(--img-height); object-fit: cover; pointer-events: none; }
        .photo-caption { height: var(--text-height); line-height: var(--text-height); text-align: center; color: white; font-size: 14px; background: rgba(212, 36, 38, 0.85); font-weight: bold; }
        
        .front  { transform: rotateY(0deg) translateZ(calc(var(--cube-size) / 2)); }
        .back   { transform: rotateY(180deg) translateZ(calc(var(--cube-size) / 2)); }
        .right  { transform: rotateY(90deg) translateZ(calc(var(--cube-size) / 2)); }
        .left   { transform: rotateY(-90deg) translateZ(calc(var(--cube-size) / 2)); }
        .top    { transform: rotateX(90deg) translateZ(calc(var(--cube-size) / 2)); }
        .bottom { transform: rotateX(-90deg) translateZ(calc(var(--cube-size) / 2)); }

        .lyrics { margin-top: 50px; text-align: center; color: #fff; z-index: 20; }
        #main-title { font-family: 'Great Vibes', cursive; font-size: 4em; margin: 0; color: var(--christmas-red); text-shadow: 0 0 20px var(--christmas-red); }

        @media (max-width: 600px) {
            .tree-container { width: 150px; }
            .cube { width: var(--mobile-size); height: var(--mobile-size); }
            .cube-face { width: var(--mobile-size); height: var(--mobile-size); }
            .cube-face img { height: var(--mobile-img-height); }
            .photo-caption { height: var(--mobile-text-height); line-height: var(--mobile-text-height); }
            .front { transform: rotateY(0deg) translateZ(calc(var(--mobile-size) / 2)); }
            .back { transform: rotateY(180deg) translateZ(calc(var(--mobile-size) / 2)); }
            .right { transform: rotateY(90deg) translateZ(calc(var(--mobile-size) / 2)); }
            .left { transform: rotateY(-90deg) translateZ(calc(var(--mobile-size) / 2)); }
            .top { transform: rotateX(90deg) translateZ(calc(var(--mobile-size) / 2)); }
            .bottom { transform: rotateX(-90deg) translateZ(calc(var(--mobile-size) / 2)); }
        }
    </style>
</head>
<body>

    <div id="overlay" onclick="startExperience()">
        <h2 style="font-size: 3em; margin:0;">ğŸ„âœ¨ğŸ</h2>
        <p style="font-size: 1.5em; margin: 15px 0;">äº²çˆ±çš„å°é½å®å®ï¼Œåœ£è¯å¿«ä¹</p>
        <p style="font-size: 0.9em; opacity: 0.7;">( ç‚¹å‡»æ­¤å¤„å¼€å¯æƒŠå–œ )</p>
    </div>

    <canvas id="snow-canvas"></canvas>
    
    <div class="decorations">
        <div class="tree-container tree-left">
            <svg viewBox="0 0 100 150"><rect x="42" y="130" width="16" height="20" fill="#4d2600"/><polygon points="50,10 10,130 90,130" fill="var(--christmas-green)"/><polygon points="50,5 53,15 63,15 55,22 58,32 50,25 42,32 45,22 37,15 47,15" fill="var(--gold)"/></svg>
        </div>
        <div class="tree-container tree-right">
            <svg viewBox="0 0 100 150"><rect x="42" y="130" width="16" height="20" fill="#4d2600"/><polygon points="50,10 10,130 90,130" fill="var(--christmas-green)"/><polygon points="50,5 53,15 63,15 55,22 58,32 50,25 42,32 45,22 37,15 47,15" fill="var(--gold)"/></svg>
        </div>
    </div>

    <div class="scene" id="interaction-area">
        <div class="cube" id="cube">
            <div class="cube-face front"><img src="1.jpg"><div class="photo-caption">è¿™æ˜¯æˆ‘ä»¬ç¬¬ä¸€æ¬¡æ‰“è§†é¢‘ï¼Œå¥½æç¬‘</div></div>
            <div class="cube-face back"><img src="2.jpg"><div class="photo-caption">ç¬¬ä¸€å¼ ç…§ç‰‡ï¼Œä¸å¤ªæ•¢äº²å¯†çš„</div></div>
            <div class="cube-face right"><img src="3.jpg"><div class="photo-caption">ç¬¬ä¸€æ¬¡é™ªå°å®åƒæµ·åº•æï¼Œä¹Ÿæ˜¯å°å®ç¬¬ä¸€æ¬¡åƒæµ·åº•æ</div></div>
            <div class="cube-face left"><img src="4.jpg"><div class="photo-caption">ç¬¬ä¸€å¼ ç‰µæ‰‹ç…§ï¼Œå˜¿å˜¿</div></div>
            <div class="cube-face top"><img src="5.jpg"><div class="photo-caption">å°å®ç§äººæ‘„å½±å¸ˆçš„æ°ä½œ</div></div>
            <div class="cube-face bottom"><img src="6.jpg"><div class="photo-caption">è„¸çº¢çº¢çš„æˆ‘ä¸æ˜¯é†‰äº†ï¼Œè€Œæ˜¯çˆ±äº†</div></div>
        </div>
        <div class="lyrics">
            <h1 id="main-title">Merry Christmas</h1>
            <p id="sub-text">ä½ å¯ä»¥æ‹¨åŠ¨æˆ‘ä»¬çš„å›å¿†</p>
        </div>
    </div>

    <audio id="bgm" src="bgm.mp3" loop preload="auto"></audio>

    <script>
        // å°†æ‰€æœ‰å˜é‡å’Œå‡½æ•°æ”¾åœ¨å…¨å±€ä½œç”¨åŸŸï¼Œç¡®ä¿ onclick èƒ½å¤Ÿè®¿é—®
        let rotateX = -20, rotateY = 20, isDragging = false, lastMouseX = 0, lastMouseY = 0;
        const cube = document.getElementById('cube');

        // æ ¸å¿ƒå‡½æ•°ï¼šå¯åŠ¨ä½“éªŒ
        function startExperience() {
            console.log("Starting experience...");
            const overlay = document.getElementById('overlay');
            const bgm = document.getElementById('bgm');

            // 1. éšè—è’™å±‚
            if (overlay) {
                overlay.style.opacity = '0';
                setTimeout(() => { overlay.style.display = 'none'; }, 500);
            }

            // 2. æ’­æ”¾èƒŒæ™¯éŸ³ä¹
            if (bgm) {
                bgm.play().catch(e => console.log("Audio play blocked or failed"));
            }

            // 3. å¼€å§‹è‡ªåŠ¨æ—‹è½¬é€»è¾‘
            requestAnimationFrame(autoRotateLoop);
        }

        // æ—‹è½¬æ›´æ–°
        function updateCube() {
            if (cube) cube.style.transform = `rotateX(${rotateX}deg) rotateY(${rotateY}deg)`;
        }

        function autoRotateLoop() {
            if (!isDragging) {
                rotateY += 0.4;
                rotateX += 0.1;
                updateCube();
            }
            requestAnimationFrame(autoRotateLoop);
        }

        // äº¤äº’é€»è¾‘
        const area = document.getElementById('interaction-area');
        const handleDown = (x, y) => { isDragging = true; lastMouseX = x; lastMouseY = y; };
        const handleMove = (x, y) => {
            if (!isDragging) return;
            rotateY += (x - lastMouseX) * 0.5;
            rotateX -= (y - lastMouseY) * 0.5;
            lastMouseX = x; lastMouseY = y;
            updateCube();
        };
        const handleUp = () => { isDragging = false; };

        area.addEventListener('mousedown', e => handleDown(e.clientX, e.clientY));
        window.addEventListener('mousemove', e => handleMove(e.clientX, e.clientY));
        window.addEventListener('mouseup', handleUp);
        area.addEventListener('touchstart', e => handleDown(e.touches[0].clientX, e.touches[0].clientY));
        window.addEventListener('touchmove', e => handleMove(e.touches[0].clientX, e.touches[0].clientY), {passive:false});
        window.addEventListener('touchend', handleUp);

        // é›ªèŠ±ç‰¹æ•ˆ (ç®€æ˜“ç‰ˆç¡®ä¿ç¨³å®š)
        const canvas = document.getElementById('snow-canvas');
        const ctx = canvas.getContext('2d');
        let particles = [];
        function initSnow() {
            canvas.width = window.innerWidth; canvas.height = window.innerHeight;
            particles = Array.from({length: 200}, () => ({
                x: Math.random() * canvas.width, y: Math.random() * canvas.height,
                r: Math.random() * 3 + 1, d: Math.random() * 1,
                s: Math.random() < 0.2
            }));
        }
        function drawSnow() {
            ctx.clearRect(0,0,canvas.width,canvas.height);
            particles.forEach(p => {
                ctx.beginPath();
                ctx.fillStyle = p.s ? "rgba(255,215,0,0.8)" : "rgba(255,255,255,0.8)";
                ctx.arc(p.x, p.y, p.r, 0, Math.PI*2);
                ctx.fill();
                p.y += Math.cos(p.d) + 1; p.x += Math.sin(p.d) * 0.5;
                if(p.y > canvas.height) { p.y = -10; p.x = Math.random()*canvas.width; }
            });
            requestAnimationFrame(drawSnow);
        }
        window.addEventListener('resize', initSnow);
        initSnow(); drawSnow();
    </script>
</body>
</html>
